# Анализатор Клинических Протоколов

Этот проект представляет собой full-stack веб-приложение, предназначенное для анализа клинических протоколов из файлов `.docx`. Он извлекает информацию о лекарственных препаратах, обогащает ее данными из внешних медицинских баз данных и предоставляет анализ с использованием ИИ для создания интерактивного, экспортируемого отчета.

## Функционал

-   **Парсинг `.docx`:** Загрузка клинического протокола в формате `.docx`.
-   **Автоматическое извлечение препаратов:** Использует ИИ (модель Gemini от Google) для определения и извлечения структурированной информации о лекарствах, упомянутых в тексте.
-   **Нормализация названий препаратов:** Сопоставляет торговые наименования с их Международным непатентованным наименованием (МНН) с помощью RxNav API, с резервным использованием ИИ.
-   **Проверка по регуляторам:** Проверяет статус одобрения препарата у крупнейших международных регуляторов:
    -   FDA (через openFDA API)
    -   EMA (через публичный API EMA)
    -   BNF и WHO EML (с помощью проверок на базе ИИ)
-   **Сравнение дозировок:** Сравнение дозировки, найденной в протоколе, со стандартной дозировкой из официальных инструкций с помощью ИИ.
-   **Интеграция с PubMed:** Загружает релевантные клинические исследования (систематические обзоры, мета-анализы, РКИ) из PubMed, с кэшированием для обеспечения производительности.
-   **Анализ с помощью ИИ:** Генерирует оценку уровня доказательности по шкале GRADE и краткую итоговую заметку на русском языке для каждого препарата.
-   **Интерактивный фронтенд:** Отзывчивый пользовательский интерфейс, созданный на React, для загрузки файлов и отображения результатов в сортируемой и фильтруемой таблице с раскрывающимися строками для деталей.
-   **Экспорт в нескольких форматах:** Экспорт итогового отчета об анализе в форматах `.docx`, `.xlsx` или `.json`.

## Технологический стек

-   **Бэкенд:** Python, FastAPI
-   **Фронтенд:** JavaScript, React
-   **ИИ:** Google Gemini (`gemini-2.5-flash`)
-   **Базы данных/API:** RxNav, openFDA, ePI от EMA, PubMed Entrez
-   **Кэширование:** Redis
-   **Ключевые библиотеки Python:** `python-docx`, `httpx`, `biopython`, `openpyxl`
-   **Ключевые библиотеки JS:** `axios`

## Установка и запуск

Следуйте этим шагам для локальной установки и запуска проекта.

### 1. Необходимые компоненты

-   Python 3.9+ и `pip`
-   Node.js и `npm`
-   Запущенный экземпляр Redis

### 2. Настройка бэкенда

1.  **Перейдите в директорию бэкенда:**
    ```bash
    cd backend
    ```

2.  **Создайте и активируйте виртуальное окружение Python:**
    ```bash
    python -m venv venv
    source venv/bin/activate  # Для Windows используйте `venv\Scripts\activate`
    ```

3.  **Установите зависимости:**
    ```bash
    pip install -r requirements.txt
    ```

4.  **Настройте переменные окружения:**
    -   Скопируйте файл-пример:
        ```bash
        cp .env.example .env
        ```
    -   Откройте новый файл `.env` и впишите ваши API-ключи для `GEMINI_API_KEY` и `PUBMED_API_KEY`, а также ваш email для `PUBMED_API_EMAIL`.

5.  **Запустите сервер бэкенда:**
    ```bash
    uvicorn main:app --reload
    ```
    API бэкенда будет доступно по адресу `http://127.0.0.1:8000`.

### 3. Настройка фронтенда

1.  **Откройте новое окно терминала.**

2.  **Перейдите в директорию фронтенда:**
    ```bash
    cd frontend
    ```

3.  **Установите зависимости:**
    ```bash
    npm install
    ```

4.  **Запустите сервер для разработки:**
    ```bash
    npm start
    ```
    Приложение React автоматически откроется в вашем браузере по адресу `http://localhost:3000`. Фронтенд настроен для проксирования API-запросов к серверу бэкенда, запущенному на порту 8000.

Теперь вы можете загрузить файл `.docx` через веб-интерфейс, чтобы начать анализ.

## Запуск с помощью Docker

Самый простой способ запустить все приложение — это использовать Docker Compose.

1.  **Убедитесь, что Docker установлен** и запущен на вашем компьютере.
2.  **Настройте переменные окружения:**
    -   Скопируйте файл-пример в директории `backend`:
        ```bash
        cp backend/.env.example backend/.env
        ```
    -   Откройте файл `backend/.env` и впишите ваши API-ключи.
3.  **Соберите и запустите сервисы:**
    -   Из корневой директории проекта выполните команду:
        ```bash
        docker-compose up --build
        ```
    - Эта команда соберет образы для бэкенда и фронтенда и запустит все три сервиса (`backend`, `frontend`, `redis`).
    - Фронтенд будет доступен по адресу `http://localhost:3000`.
